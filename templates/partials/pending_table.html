<!-- Pending Files Table Partial -->

<!-- Batch Action Bar (sticky at top) -->
<div id="batch-action-bar" class="hidden sticky top-0 z-10 mb-4 p-3 rounded-lg flex items-center justify-between"
    style="background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);">
    <span class="text-white font-medium">
        <span id="selected-count">0</span> files selected
    </span>
    <div class="flex gap-2">
        <button onclick="openBatchModal()"
            class="px-4 py-1.5 bg-white/20 hover:bg-white/30 rounded text-white text-sm font-medium">
            Approve Selected
        </button>
        <button
            onclick="selectedFiles.clear(); updateBatchActionBar(); document.querySelectorAll('.file-checkbox').forEach(cb => cb.checked = false);"
            class="px-4 py-1.5 bg-white/10 hover:bg-white/20 rounded text-white text-sm">
            Clear
        </button>
    </div>
</div>

<!-- Controls Bar -->
<div class="flex items-center justify-between mb-4">
    <!-- Pagination Size -->
    <div class="flex items-center gap-2">
        <label class="text-sm text-gray-400">Show:</label>
        <select
            onchange="htmx.ajax('GET', '/pending?per_page=' + this.value, {target:'#pending-content > div', swap:'innerHTML'})"
            class="bg-gray-800 border border-gray-700 rounded px-3 py-1 text-sm text-white">
            <option value="50" {% if per_page==50 %}selected{% endif %}>50</option>
            <option value="100" {% if per_page==100 %}selected{% endif %}>100</option>
            <option value="500" {% if per_page==500 %}selected{% endif %}>500</option>
        </select>
    </div>

    <!-- File Count -->
    <span class="text-sm text-gray-400">
        {{ total }} files
        {% if total_pages > 1 %} ‚Ä¢ Page {{ page }} of {{ total_pages }}{% endif %}
    </span>
</div>

<!-- Table -->
{% if files %}
<div class="overflow-x-auto">
    <table class="w-full">
        <thead>
            <tr class="text-left text-sm text-gray-400 border-b border-gray-800">
                <th class="pb-3 w-10">
                    <input type="checkbox" onchange="toggleAllFiles(this)" class="rounded bg-gray-700 border-gray-600">
                </th>
                <th class="pb-3 sortable"
                    hx-get="/pending?sort=file_type&order={{ 'asc' if sort == 'file_type' and order == 'desc' else 'desc' }}&per_page={{ per_page }}"
                    hx-target="#pending-content > div" hx-swap="innerHTML">
                    Type {% if sort == 'file_type' %}{{ '‚Üë' if order == 'asc' else '‚Üì' }}{% endif %}
                </th>
                <th class="pb-3 sortable"
                    hx-get="/pending?sort=file_name&order={{ 'asc' if sort == 'file_name' and order == 'desc' else 'desc' }}&per_page={{ per_page }}"
                    hx-target="#pending-content > div" hx-swap="innerHTML">
                    Name {% if sort == 'file_name' %}{{ '‚Üë' if order == 'asc' else '‚Üì' }}{% endif %}
                </th>
                <th class="pb-3 sortable"
                    hx-get="/pending?sort=file_size&order={{ 'asc' if sort == 'file_size' and order == 'desc' else 'desc' }}&per_page={{ per_page }}"
                    hx-target="#pending-content > div" hx-swap="innerHTML">
                    Size {% if sort == 'file_size' %}{{ '‚Üë' if order == 'asc' else '‚Üì' }}{% endif %}
                </th>
                <th class="pb-3">Category</th>
                <th class="pb-3 sortable"
                    hx-get="/pending?sort=created_at&order={{ 'asc' if sort == 'created_at' and order == 'desc' else 'desc' }}&per_page={{ per_page }}"
                    hx-target="#pending-content > div" hx-swap="innerHTML">
                    Date {% if sort == 'created_at' %}{{ '‚Üë' if order == 'asc' else '‚Üì' }}{% endif %}
                </th>
                <th class="pb-3 text-right">Action</th>
            </tr>
        </thead>
        <tbody class="text-sm">
            {% for file in files %}
            {% include 'partials/file_row.html' %}
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Pagination -->
{% if total_pages > 1 %}
<div class="flex items-center justify-center gap-2 mt-6">
    {% if page > 1 %}
    <button hx-get="/pending?page={{ page - 1 }}&per_page={{ per_page }}&sort={{ sort }}&order={{ order }}"
        hx-target="#pending-content > div" hx-swap="innerHTML"
        class="px-3 py-1 bg-gray-800 hover:bg-gray-700 rounded text-sm">
        ‚Üê Prev
    </button>
    {% endif %}

    <span class="px-3 py-1 text-gray-400 text-sm">
        Page {{ page }} of {{ total_pages }}
    </span>

    {% if page < total_pages %} <button
        hx-get="/pending?page={{ page + 1 }}&per_page={{ per_page }}&sort={{ sort }}&order={{ order }}"
        hx-target="#pending-content > div" hx-swap="innerHTML"
        class="px-3 py-1 bg-gray-800 hover:bg-gray-700 rounded text-sm">
        Next ‚Üí
        </button>
        {% endif %}
</div>
{% endif %}

{% else %}
<div class="text-center py-12">
    <div class="text-4xl mb-3">üì≠</div>
    <p class="text-gray-400">No pending files</p>
    <p class="text-sm text-gray-500 mt-1">Add channels to start scanning for files</p>
</div>
{% endif %}