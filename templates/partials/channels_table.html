<!-- Channels Table Partial -->

{% if success_message %}
<div class="mb-4 p-3 bg-green-500/20 border border-green-500/50 rounded-lg text-green-400 text-sm">
    {{ success_message }}
</div>
{% endif %}

{% if channels %}
<div class="overflow-x-auto">
    <table class="w-full">
        <thead>
            <tr class="text-left text-sm text-gray-400 border-b border-gray-800">
                <th class="pb-3">Channel</th>
                <th class="pb-3">Username</th>
                <th class="pb-3">Last Scanned</th>
                <th class="pb-3 text-right">Actions</th>
            </tr>
        </thead>
        <tbody class="text-sm">
            {% for channel in channels %}
            <tr class="border-b border-gray-800/50 hover:bg-gray-800/30">
                <!-- Name -->
                <td class="py-3">
                    <div class="flex items-center gap-3">
                        <div
                            class="w-8 h-8 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400">
                            ðŸ“¡
                        </div>
                        <span class="text-white font-medium">{{ channel.name or 'Unknown' }}</span>
                    </div>
                </td>

                <!-- Username -->
                <td class="py-3 text-gray-400">
                    {% if channel.username %}
                    <a href="https://t.me/{{ channel.username }}" target="_blank"
                        class="hover:text-indigo-400 transition-colors">
                        @{{ channel.username }}
                    </a>
                    {% else %}
                    <span class="text-gray-500">Private</span>
                    {% endif %}
                </td>

                <!-- Last Scanned -->
                <td class="py-3 text-gray-400 text-xs">
                    {% if channel.last_scanned_message_id > 0 %}
                    ID: {{ channel.last_scanned_message_id }}
                    {% else %}
                    Never
                    {% endif %}
                </td>

                <!-- Actions -->
                <td class="py-3 text-right">
                    <div class="flex items-center justify-end gap-2">
                        <!-- Scan Now (recent 500) -->
                        <button hx-post="/channels/{{ channel.id }}/scan" hx-swap="beforeend" hx-target="closest tr"
                            class="px-3 py-1 rounded bg-indigo-600 hover:bg-indigo-500 text-white text-xs">
                            Scan
                        </button>

                        <!-- Full Scan (all messages) -->
                        <button hx-post="/channels/{{ channel.id }}/full-scan" hx-swap="beforeend"
                            hx-target="closest tr"
                            hx-confirm="Full scan will fetch ALL messages. This may take a while for large channels. Continue?"
                            class="px-3 py-1 rounded bg-amber-600 hover:bg-amber-500 text-white text-xs">
                            Full Scan
                        </button>

                        <!-- Remove -->
                        <button hx-post="/channels/{{ channel.id }}/remove" hx-target="#channels-list"
                            hx-swap="innerHTML" hx-confirm="Remove this channel?"
                            class="px-3 py-1 rounded bg-red-600/20 hover:bg-red-600/40 text-red-400 text-xs">
                            Remove
                        </button>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="text-center py-12">
    <div class="text-4xl mb-3">ðŸ“¡</div>
    <p class="text-gray-400">No channels added</p>
    <p class="text-sm text-gray-500 mt-1">Add a Telegram channel to start scanning for files</p>
</div>
{% endif %}